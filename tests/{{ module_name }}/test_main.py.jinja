"""Tests for the main {{ module_name }} module."""

from typing import List
import pytest

from {{ module_name }} import main, greet, get_version, __version__


def test_main_function_output(capsys) -> None:
    """Test that the main function prints the expected output."""
    main()
    captured = capsys.readouterr()
    assert "Hello from {{ package_name }}!" in captured.out
    assert "Version:" in captured.out


def test_greet_function_default() -> None:
    """Test greet function with default parameter."""
    result = greet()
    assert result == "Hello, World! Welcome to {{ project_name }}."


def test_greet_function_custom_name() -> None:
    """Test greet function with custom name."""
    result = greet("Alice")
    assert result == "Hello, Alice! Welcome to {{ project_name }}."


def test_greet_function_empty_name() -> None:
    """Test greet function with empty name."""
    result = greet("")
    assert result == "Hello, ! Welcome to {{ project_name }}."


def test_get_version() -> None:
    """Test that get_version returns the package version."""
    version = get_version()
    assert version == __version__
    assert isinstance(version, str)
    assert len(version) > 0


def test_version_format() -> None:
    """Test that version follows semantic versioning pattern."""
    version = __version__
    
    # Basic version format check (allows dev versions)
    assert isinstance(version, str)
    assert len(version) > 0
    
    # Should contain at least major.minor
    parts = version.split('.')
    assert len(parts) >= 2
    
    # First part should be numeric
    assert parts[0].isdigit()


@pytest.mark.parametrize("name,expected", [
    ("Developer", "Hello, Developer! Welcome to {{ project_name }}."),
    ("Test User", "Hello, Test User! Welcome to {{ project_name }}."),
    ("123", "Hello, 123! Welcome to {{ project_name }}."),
])
def test_greet_function_parametrized(name: str, expected: str) -> None:
    """Test greet function with various inputs using parametrize."""
    result = greet(name)
    assert result == expected


class TestMainModule:
    """Test class for grouping related tests."""
    
    def test_module_has_required_attributes(self) -> None:
        """Test that the module has all required attributes."""
        import {{ module_name }}
        
        # Check required functions exist
        assert hasattr({{ module_name }}, 'main')
        assert hasattr({{ module_name }}, 'greet')
        assert hasattr({{ module_name }}, 'get_version')
        
        # Check version attribute exists
        assert hasattr({{ module_name }}, '__version__')
        
        # Check functions are callable
        assert callable({{ module_name }}.main)
        assert callable({{ module_name }}.greet)
        assert callable({{ module_name }}.get_version)
    
    def test_main_function_no_exceptions(self) -> None:
        """Test that main function runs without exceptions."""
        try:
            main()
        except Exception as e:
            pytest.fail(f"main() raised {type(e).__name__}: {e}")
    
    def test_version_consistency(self) -> None:
        """Test that different version access methods are consistent."""
        import {{ module_name }}
        
        # All should return the same version
        assert {{ module_name }}.__version__ == get_version()
        
        # Should be string type
        assert isinstance({{ module_name }}.__version__, str)


# Integration test
def test_full_workflow() -> None:
    """Test a complete workflow using multiple functions."""
    # Get version
    version = get_version()
    assert version
    
    # Test greeting
    greeting = greet("Integration Test")
    assert "Integration Test" in greeting
    assert "{{ project_name }}" in greeting
    
    # Test main function (should not raise exceptions)
    main()